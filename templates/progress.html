{% extends "base.html" %}

{% block title %}Scanning... â€” User Manual Agent{% endblock %}

{% block content %}
<div class="progress-container glass-card">
    <div class="progress-header">
        <h2 id="phase-title">Opening browser...</h2>
        <span class="status-badge" id="status-badge">Initializing</span>
    </div>

    <!-- Login prompt â€” shown while waiting for user -->
    <div id="login-prompt" class="login-prompt">
        <div class="login-prompt-icon">ğŸŒ</div>
        <h3>A browser window has opened</h3>
        <p>Log in to the application and navigate wherever you need. When you're ready, click the button below to start
            the crawl.</p>
        <button class="btn btn-primary" id="begin-crawl-btn" onclick="beginCrawl('{{ scan_id }}')">
            âœ… I'm Logged In â€” Begin Crawl
        </button>
    </div>

    <!-- Progress UI â€” shown during crawling -->
    <div id="crawl-progress" style="display:none;">
        <div class="progress-bar-wrapper">
            <div class="progress-bar" id="progress-bar" style="width: 0%"></div>
        </div>

        <div class="progress-stats">
            <div class="stat">
                <span class="stat-value" id="pages-visited">0</span>
                <span class="stat-label">Pages Visited</span>
            </div>
            <div class="stat">
                <span class="stat-value" id="pages-queued">0</span>
                <span class="stat-label">Pages Queued</span>
            </div>
            <div class="stat">
                <span class="stat-value" id="phase-label">â€”</span>
                <span class="stat-label">Phase</span>
            </div>
        </div>

        <div class="current-activity">
            <div class="activity-dot"></div>
            <span id="current-url">Preparing...</span>
        </div>
    </div>

    <div id="error-message" class="error-box" style="display:none;"></div>

    <div id="done-actions" class="done-actions" style="display:none;">
        <a id="view-manual-btn" href="#" class="btn btn-primary">ğŸ“˜ View Manual</a>
        <a id="download-html-btn" href="#" class="btn btn-secondary">â¬‡ Download HTML</a>
        <a id="download-md-btn" href="#" class="btn btn-secondary">â¬‡ Download Markdown</a>
    </div>
</div>

<div id="pages-list" class="pages-list"></div>
{% endblock %}

{% block scripts %}
<script>
    initProgress('{{ scan_id }}');
</script>
{% endblock %}